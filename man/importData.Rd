% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/importData.R
\name{importData}
\alias{importData}
\title{importData}
\usage{
importData(
  type = "local",
  server = NA,
  dbname = "FFI_RA_AGFO",
  new_env = T,
  export_views = F,
  export_tables = F,
  export_path = NA,
  import_path = NA,
  keep_tables = F
)
}
\arguments{
\item{type}{Indicate how to import the database tables
\describe{
\item{"local"}{Import tables in 'dbo' schema from the local installation of an FFI database in SQL Server Management Studio (SSMS).}
\item{"server"}{Import tables in 'dbo' schema from the FFI database on the production SQL Server (not enabled).}
\item{"csv"}{ Import zip file containing csvs that were exported from the FFI database. Option doesn't require SSMS to be installed (not yet enabled).}
}}

\item{server}{If type = 'server', requires quoted FFI server address (not currently enabled).}

\item{dbname}{If type = "server" or "local", quoted name of database matching the name of the database (eg. "FFI_RA_AGFO"). If
multiple database names are specified, views will be row bound for tables in common for all of the databases with a column
indicating the dbname in each table. Note that the tables being row binded must be identical for this to work, and there
aren't thorough checks built in the function to ensure that's true (i.e., it's likely to fail, but the error message may be weird).}

\item{new_env}{Logical. If TRUE (default), will import tables to VIEWS_NGPN environment. If FALSE, will import tables to global
environment.}

\item{export_views}{Logical. If TRUE, will export a zip file of csvs to specified export_path for the flattened views of the data.
Views are the analysis-ready files that have all associated MacroPlot, Sample Event, and sample data for a given FFI protocol (e.g. Point Intercept).}

\item{export_tables}{Logical. If TRUE, will export a zip file of csvs to specified export_path for the raw data tables from the FFI database.
The raw tables are what can be imported the same as importing from a local instance of the FFI database.}

\item{export_path}{Quoted string to export zipped csvs to if export = TRUE. If not specified, will export to the working directory.}

\item{import_path}{Quoted string to import a zipped file of csvs if type = 'csv'. The name of the zipped file should be included
in the path. Can specify multiple paths to import multiple parks/projects.}

\item{keep_tables}{Logical. If TRUE, will return the raw FFI database tables in a NGPN_tables environment. If FALSE (default),
only returns the flattened views. This feature is primarily for internal use to QC the original data.}
}
\value{
Either an environment of NGPN_PCM views as data frames and possibly an environment of the original FFI database tables.
}
\description{
Imports data from FFI SQL Server database or csvs of FFI database tables using the schema designed for
the Northern Great Plains Network plant community monitoring protocol. Currently can only import from a local installation
of a park FFI database in SQL Server Management Studio (SSMS), but the goal is to add an option for importing directly
from the SQL Server where the production FFI databases are housed. If multiple parks worth of data are imported, tables
are row binded, so that all NPGN parks can be queried, summarized, etc. at once. After raw FFI tables are imported, they
are then joined into flattened views for each protocol. The views currently only include plots that are part of NGPN PCM monitoring,
and only include sample events from 2011 and on, but this can be revised as needed. The raw tables with all data and views of
only NGPN PCM plots >= 2011 can both be  exported via the export arguments. Function is slow if running for all parks and
exporting tables or views. Once the views are created/exported, they can be imported using importViews() for faster importing.
Note that view column names dropped the original table name (eg 'MacroPlot_', 'SampleEvent') where unnecessary for easier coding.
}
\examples{
\dontrun{
library(plantcomNGPN)
#--- From Local install of FFI SQL databases
# Import data for AGFO and export tables to zip file
importData(type = 'local', dbname = c("FFI_RA_AGFO"), export_tables = T, export_views = T)

# Import data for all NGPN parks (takes a few seconds) from local copy on SSMS
# and export both the analysis-ready views and the raw tables.
importData(type = 'local',
           dbname = c("FFI_RA_AGFO", "FFI_RA_BADL", "FFI_RA_DETO", "FFI_RA_FOLA",
                      "FFI_RA_FOUS", "FFI_RA_JECA", "FFI_RA_KNRI", "FFI_RA_MNRR",
                      "FFI_RA_MORU", "FFI_RA_SCBL", "FFI_RA_THRO", "FFI_RA_WICA"),
           export_views = T, export_tables = T,
           export_path = "C:/temp")

# Check that the multiple-park import worked
table(NGPN_tables$MacroPlot$datasource)

#--- From zipped csvs of FFI data
# Import THRO from zip file
importData(type = 'csv', import_path = "C:/temp/FFI_RA_THRO.zip")

# Import zipped files of NGPN parks and export as 1 zip file with all parks included
zips <- c("NGPN_FFI_tables_AGFO_20250508.zip", "NGPN_FFI_tables_BADL_20250508.zip", "NGPN_FFI_tables_DETO_20250508.zip",
          "NGPN_FFI_tables_FOLA_20250508.zip", "NGPN_FFI_tables_FOUS_20250508.zip", "NGPN_FFI_tables_JECA_20250508.zip",
          "NGPN_FFI_tables_KNRI_20250508.zip", "NGPN_FFI_tables_MORU_20250508.zip", "NGPN_FFI_tables_SCBL_20250508.zip",
          "NGPN_FFI_tables_THRO_20250508.zip", "NGPN_FFI_tables_WICA_20250508.zip")
filepath = "C:/Users/KMMiller/OneDrive - DOI/MWR/NGPN_veg/FFI_zips/"
zips_full <- paste0(filepath, zips)
importData(type = 'csv', import_path = zips_full, export_tables = T)

}

}
